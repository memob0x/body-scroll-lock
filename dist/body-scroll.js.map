{"version":3,"sources":["body-scroll.mjs"],"names":["global","factory","exports","module","define","amd","self","bodyScroll","$head","document","head","$html","documentElement","$body","body","createStyle","$el","createElement","type","$stylerBase","$stylerResizable","isLegacyIOS","test","window","navigator","userAgent","isMultiTouchMacAkaIOS13","platform","maxTouchPoints","isAppleTouchDevice","BodyScrollEvent","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","prototype","Event","status","scroll","x","y","scrollbarWidth","clientWidth","getBaseRules","output","getResizableRules","printRules","$actor","rules","styleSheet","cssText","appendChild","createTextNode","parentNode","append","printBaseRules","printResizableRules","resize","isLocked","lock","scrollX","scrollY","_clientWidth","style","width","overflow","dispatchEvent","addEventListener","unlock","innerHTML","removeEventListener","toggle"],"mappings":"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","file":"body-scroll.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global = global || self, global.bodyScroll = factory());\n}(this, function () { 'use strict';\n\n    // main elements\n    const $head = document.head;\n    const $html = document.documentElement;\n    const $body = document.body;\n\n    // stylers\n    const createStyle = () => {\n        const $el = document.createElement(\"style\");\n        $el.type = \"text/css\";\n        return $el;\n    };\n    const $stylerBase = createStyle();\n    const $stylerResizable = createStyle();\n\n    // Apple devices recognition\n    const isLegacyIOS = /iPad|iPhone|iPod/.test(window.navigator.userAgent);\n    const isMultiTouchMacAkaIOS13 =\n        window.navigator.platform === \"MacIntel\" &&\n        window.navigator.maxTouchPoints > 1;\n    const isAppleTouchDevice = isLegacyIOS || isMultiTouchMacAkaIOS13;\n\n    const BodyScrollEvent = (() => {\n        if (typeof window.CustomEvent === \"function\") {\n            return window.CustomEvent;\n        }\n\n        function CustomEvent(event, params) {\n            params = params || {\n                bubbles: false,\n                cancelable: false,\n                detail: undefined\n            };\n\n            const evt = document.createEvent(\"CustomEvent\");\n\n            evt.initCustomEvent(\n                event,\n                params.bubbles,\n                params.cancelable,\n                params.detail\n            );\n\n            return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        return CustomEvent;\n    })();\n\n    // local vars\n    let status = false;\n    let scroll = {\n        x: 0,\n        y: 0\n    };\n    let scrollbarWidth = 0;\n    let clientWidth = 0;\n\n    /**\n     * Gets the CSS rules that can't be influenced by a window resize\n     * @returns {string} CSS rules\n     */\n    const getBaseRules = () => {\n        let output = `html, body {\n        height: auto!important;\n        margin: 0!important;\n        padding: 0 ${scrollbarWidth}px 0 0!important;\n    }`;\n\n        if (isAppleTouchDevice) {\n            output += `html {\n            position: fixed!important;\n            top: ${-1 * scroll.y}px!important;\n            left: ${-1 * scroll.x}px!important;\n            overflow: visible!important;\n        }`;\n        } else {\n            output += `body {\n            overflow: hidden!important;\n        }`;\n        }\n\n        return output;\n    };\n\n    /**\n     * Gets the CSS rules that can be influenced by a window resize\n     * @returns {string} CSS rules\n     */\n    const getResizableRules = () => {\n        return `html, body {\n        width: ${clientWidth}px!important;\n    }`;\n    };\n\n    /**\n     * Sets some CSS rules to a style element\n     * @param {HTMLElement} $actor A style element\n     * @param {string} rules The CSS rules\n     */\n    const printRules = ($actor, rules) => {\n        if ($actor.styleSheet) {\n            $actor.styleSheet.cssText = rules;\n        } else {\n            $actor.appendChild(document.createTextNode(rules));\n        }\n\n        if ($actor.parentNode !== $head) {\n            $head.append($actor);\n        }\n    };\n\n    // shorthand style printers\n    const printBaseRules = () => printRules($stylerBase, getBaseRules());\n    const printResizableRules = () =>\n        printRules($stylerResizable, getResizableRules());\n\n    /**\n     * Resize handler to refresh the CSS rules when body scroll is locked\n     */\n    const resize = () => {\n        if (!status) {\n            return;\n        }\n\n        clientWidth = $html.clientWidth;\n\n        printResizableRules();\n    };\n\n    /**\n     * Returns whether the body scroll is locked or not\n     * @returns {boolean} The body scroll lock state\n     */\n    const isLocked = () => status;\n\n    /**\n     * Locks the body scroll\n     * @returns {boolean} Whether the lock action has been successful of not\n     */\n    const lock = () => {\n        if (status) {\n            return false;\n        }\n\n        status = true;\n\n        if (isAppleTouchDevice) {\n            scroll = {\n                x: window.scrollX,\n                y: window.scrollY\n            };\n        }\n\n        const _clientWidth = $html.clientWidth;\n        $body.style.width = $body.clientWidth + \"px\";\n        $html.style.overflow = \"hidden\";\n        clientWidth = $html.clientWidth;\n        scrollbarWidth = clientWidth - _clientWidth;\n        $body.style.width = \"\";\n        $html.style.overflow = \"\";\n\n        printBaseRules();\n        printResizableRules();\n\n        if (isAppleTouchDevice) {\n            window.scroll(0, 0);\n        }\n\n        window.dispatchEvent(\n            new BodyScrollEvent(\"bodyScrollLock\", {\n                detail: {\n                    clientWidth: clientWidth,\n                    scrollbarWidth: scrollbarWidth\n                }\n            })\n        );\n\n        document.addEventListener(\"resize\", resize);\n\n        return true;\n    };\n\n    /**\n     * Unlocks the body scroll\n     * @returns {boolean} Whether the unlock action has been successful of not\n     */\n    const unlock = () => {\n        if (!status) {\n            return false;\n        }\n\n        status = false;\n\n        $stylerBase.innerHTML = \"\";\n        $stylerResizable.innerHTML = \"\";\n\n        if (isAppleTouchDevice) {\n            window.scroll(scroll.x, scroll.y);\n        }\n\n        window.dispatchEvent(\n            new BodyScrollEvent(\"bodyScrollUnlock\", {\n                detail: {\n                    clientWidth: clientWidth,\n                    scrollbarWidth: scrollbarWidth\n                }\n            })\n        );\n\n        document.removeEventListener(\"resize\", resize);\n\n        return true;\n    };\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: () => (!isLocked() ? lock() : unlock()),\n        isLocked: isLocked\n    };\n\n    return bodyScroll;\n\n}));\n"]}