{"version":3,"sources":["body-scroll.mjs"],"names":["global","factory","exports","module","define","amd","self","bodyScroll","$head","document","head","$html","documentElement","$body","body","$style","createElement","isLegacyIOS","test","window","navigator","userAgent","isMultiTouchMacAkaIOS13","platform","maxTouchPoints","isAppleTouchDevice","scrollPosition","x","y","scrollbarWidth","clientWidth","isStyleElementInHead","parentNode","insertIndexedRule","rule","index","appendChild","sheet","cssRules","deleteRule","insertRule","insertBaseRules","insertResizableRules","resizeListener","isLocked","disabled","lock","scrollX","scrollY","_clientWidth","style","width","overflow","scroll","dispatchEvent","CustomEvent","detail","addEventListener","unlock","removeEventListener","toggle"],"mappings":"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","file":"body-scroll.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global = global || self, global.bodyScroll = factory());\n}(this, function () { 'use strict';\n\n    // elements involved\n    const $head = document.head;\n    const $html = document.documentElement;\n    const $body = document.body;\n    const $style = document.createElement(\"style\");\n\n    // Apple devices recognition\n    const isLegacyIOS = /iPad|iPhone|iPod/.test(window.navigator.userAgent);\n    const isMultiTouchMacAkaIOS13 =\n        window.navigator.platform === \"MacIntel\" &&\n        window.navigator.maxTouchPoints > 1;\n    const isAppleTouchDevice = isLegacyIOS || isMultiTouchMacAkaIOS13;\n\n    let scrollPosition = {\n        x: 0,\n        y: 0\n    };\n    let scrollbarWidth = 0;\n    let clientWidth = 0;\n\n    /**\n     * Checks if the style element is in the tag head or not\n     * @returns {boolean} true if present\n     */\n    const isStyleElementInHead = () => $style.parentNode === $head;\n\n    /**\n     * Inserts a rule with the CSSStyleSheet interface\n     * @param {string} rule The CSS rule to add\n     * @param {number} index The index of the CSS rule in the CSSRulesList\n     */\n    const insertIndexedRule = (rule = \"\", index = 0) => {\n        if (!isStyleElementInHead()) {\n            $head.appendChild($style);\n        }\n\n        if ($style.sheet.cssRules[index]) {\n            $style.sheet.deleteRule(index);\n        }\n\n        $style.sheet.insertRule(rule, index);\n    };\n\n    /**\n     * Inserts the CSS rules that doesn't need to be recalculated on resize\n     */\n    const insertBaseRules = () => {\n        insertIndexedRule(\n            `html, body {\n            height: auto!important;\n            margin: 0!important;\n            padding: 0 ${scrollbarWidth}px 0 0!important;\n        }`,\n            0\n        );\n\n        if (isAppleTouchDevice) {\n            insertIndexedRule(\n                `html {\n                position: fixed!important;\n                top: ${-1 * scrollPosition.y}px!important;\n                left: ${-1 * scrollPosition.x}px!important;\n                overflow: visible!important;\n            }`,\n                1\n            );\n        } else {\n            insertIndexedRule(\n                `body {\n                overflow: hidden!important;\n            }`,\n                1\n            );\n        }\n    };\n\n    /**\n     * Inserts the CSS rules that need to be recalculated on resize\n     */\n    const insertResizableRules = () =>\n        insertIndexedRule(\n            `html, body {\n            width: ${clientWidth}px!important;\n        }`,\n            2\n        );\n\n    /**\n     *\n     */\n    const resizeListener = () => {\n        clientWidth = $html.clientWidth;\n\n        insertResizableRules();\n    };\n\n    /**\n     * Returns whether the body scroll is locked or not\n     * @returns {boolean} The body scroll lock state\n     */\n    const isLocked = () => isStyleElementInHead() && !$style.disabled;\n\n    /**\n     * Locks the body scroll\n     * @returns {boolean} Whether the lock action has been successful of not (false if already locked)\n     */\n    const lock = () => {\n        if (isLocked()) {\n            return false;\n        }\n\n        if (isAppleTouchDevice) {\n            scrollPosition = {\n                x: window.scrollX,\n                y: window.scrollY\n            };\n        }\n\n        const _clientWidth = $html.clientWidth;\n        $body.style.width = $body.clientWidth + \"px\";\n        $html.style.overflow = \"hidden\";\n        clientWidth = $html.clientWidth;\n        scrollbarWidth = clientWidth - _clientWidth;\n        $body.style.width = \"\";\n        $html.style.overflow = \"\";\n\n        insertBaseRules();\n        insertResizableRules();\n\n        $style.disabled = false;\n\n        if (isAppleTouchDevice) {\n            window.scroll(0, 0);\n        }\n\n        window.dispatchEvent(\n            new CustomEvent(\"bodyScrollLock\", {\n                detail: {\n                    clientWidth: clientWidth,\n                    scrollbarWidth: scrollbarWidth\n                }\n            })\n        );\n\n        window.addEventListener(\"resize\", resizeListener);\n\n        return true;\n    };\n\n    /**\n     * Unlocks the body scroll\n     * @returns {boolean} Whether the unlock action has been successful of not (false if already unlocked)\n     */\n    const unlock = () => {\n        if (!isLocked()) {\n            return false;\n        }\n\n        $style.disabled = true;\n\n        if (isAppleTouchDevice) {\n            window.scroll(scrollPosition.x, scrollPosition.y);\n        }\n\n        window.dispatchEvent(\n            new CustomEvent(\"bodyScrollUnlock\", {\n                detail: {\n                    clientWidth: clientWidth,\n                    scrollbarWidth: scrollbarWidth\n                }\n            })\n        );\n\n        window.removeEventListener(\"resize\", resizeListener);\n\n        return true;\n    };\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: () => (!isLocked() ? lock() : unlock()),\n        isLocked: isLocked\n    };\n\n    return bodyScroll;\n\n}));\n"]}