{"version":3,"sources":["body-scroll.mjs"],"names":["global","factory","exports","module","define","amd","bodyScroll","html","document","documentElement","head","getElementsByTagName","BodyScrollEvent","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","prototype","Event","status","setStatus","bool","state","scroll","top","left","behavior","width","height","body","scrollbars","y","x","setState","vw","innerWidth","vh","innerHeight","clientWidth","clientHeight","scrollTop","scrollLeft","scrollWidth","scrollHeight","settings","important","corrections","defaultCorrection","selector","property","inverted","supportedProperties","setCorrections","collection","collectionType","Array","isArray","forEach","entry","entryType","push","indexOf","setOptions","options","stylerID","styler","createElement","type","id","setStyle","css","remove","styleSheet","cssText","innerHTML","appendChild","createTextNode","querySelector","getStyle","imp","length","gap","factor","updateStyle","lock","dispatchEvent","unlock","scrollTo","toggle","timer","addEventListener","clearTimeout","setTimeout","isLocked"],"mappings":"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","file":"body-scroll.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global.bodyScroll = factory());\n}(this, (function () { 'use strict';\n\n    const html = document.documentElement;\n    const head = document.head || document.getElementsByTagName('head')[0];\n\n    const BodyScrollEvent = (() => {\n        if (typeof window.CustomEvent === 'function') {\n            return window.CustomEvent;\n        }\n\n        function CustomEvent(event, params) {\n            params = params || {\n                bubbles: false,\n                cancelable: false,\n                detail: undefined\n            };\n\n            const evt = document.createEvent('CustomEvent');\n\n            evt.initCustomEvent(\n                event,\n                params.bubbles,\n                params.cancelable,\n                params.detail\n            );\n\n            return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        return CustomEvent;\n    })();\n\n    let status = false;\n    const setStatus = (bool = true) => (status = bool);\n\n    let state = {\n        scroll: {\n            top: 0,\n            left: 0,\n            behavior: 'auto'\n        },\n        html: {\n            width: 0,\n            height: 0\n        },\n        body: {\n            width: 0,\n            height: 0\n        },\n        scrollbars: {\n            y: 0,\n            x: 0\n        }\n    };\n\n    const setState = () => {\n        const vw = window.innerWidth;\n        const vh = window.innerHeight;\n        const width = html.clientWidth;\n        const height = html.clientHeight;\n        const scroll = {\n            top: html.scrollTop,\n            left: html.scrollLeft\n        };\n        const scrollbars = {\n            y: vw > width ? vw - width : 0,\n            x: vh > height ? vh - height : 0\n        };\n\n        state = {\n            ...state,\n            ...{\n                scroll: scroll,\n                html: {\n                    width: vw + scroll.left - scrollbars.y,\n                    height: vh + scroll.top - scrollbars.x\n                },\n                body: {\n                    width: html.scrollWidth,\n                    height: html.scrollHeight\n                },\n                scrollbars: scrollbars\n            }\n        };\n    };\n\n    let settings = {\n        important: true,\n        corrections: []\n    };\n\n    const defaultCorrection = {\n        selector: null,\n        property: 'margin-right',\n        inverted: false\n    };\n\n    const supportedProperties = [\n        'margin-right',\n        'margin-bottom',\n        'padding-right',\n        'padding-bottom',\n        'right',\n        'bottom'\n    ];\n\n    // TODO: put in setOptions\n    const setCorrections = (collection = []) => {\n        let corrections = [];\n\n        const collectionType = typeof collection;\n        if (\n            collectionType === 'string' ||\n            (!Array.isArray(collection) && collectionType === 'object')\n        ) {\n            collection = [collection];\n        }\n\n        collection.forEach(entry => {\n            if (entry) {\n                const entryType = typeof entry;\n\n                if (entryType === 'string') {\n                    corrections.push({\n                        ...defaultCorrection,\n                        ...{\n                            selector: entry\n                        }\n                    });\n                }\n\n                if (\n                    !Array.isArray(entry) &&\n                    entryType === 'object' &&\n                    entry.selector &&\n                    (!entry.property ||\n                        supportedProperties.indexOf(entry.property) > -1)\n                ) {\n                    corrections.push({\n                        ...defaultCorrection,\n                        ...entry\n                    });\n                }\n            }\n        });\n\n        return corrections;\n    };\n\n    const setOptions = (options = {}) => {\n        if (!status) {\n            settings = {\n                ...settings,\n                ...options\n            };\n            settings.corrections = setCorrections(settings.corrections);\n        }\n    };\n\n    const stylerID = 'body-scroll';\n    const styler = document.createElement('style');\n    styler.type = 'text/css';\n    styler.id = stylerID;\n\n    const setStyle = (css = '') => {\n        if (!css) {\n            styler.remove();\n\n            return;\n        }\n\n        if (styler.styleSheet) {\n            styler.styleSheet.cssText = css;\n        } else {\n            styler.innerHTML = '';\n            styler.appendChild(document.createTextNode(css));\n        }\n\n        if (!head.querySelector(`style#${stylerID}`)) {\n            head.appendChild(styler);\n        }\n    };\n\n    const getStyle = () => {\n        const imp = settings.important ? '!important' : '';\n\n        let css = '';\n\n        if (!status) {\n            css += `html,\n            body {\n            margin: 0${imp};\n            padding: 0${imp};\n            min-width: auto${imp};\n            min-height: auto${imp};\n            max-width: none${imp};\n            max-height: none${imp};\n        }\n\n        html {\n            width: ${state.html.width}px${imp};\n            height: ${state.html.height}px${imp};\n        }\n\n        html {\n            position: fixed${imp};\n            top: ${state.scroll.top * -1}px${imp};\n            left: ${state.scroll.left * -1}px${imp};\n        }\n\n        html,\n            body {\n            overflow: visible${imp};\n        }\n\n        body{\n            width: ${state.body.width}px${imp};\n            height: ${state.body.height}px${imp};\n        }`;\n        }\n\n        const corrections = settings.corrections;\n\n        if (corrections.length) {\n            corrections.forEach(entry => {\n                const gap =\n                    state.scrollbars[\n                        entry.property.indexOf('right') > -1 ? 'y' : 'x'\n                    ];\n\n                if (gap > 0) {\n                    let factor = 1;\n\n                    if (status) {\n                        factor = entry.inverted ? -1 : 0;\n                    }\n\n                    css += `\n                ${entry.selector} {\n                    ${entry.property}: ${gap * factor}px${\n                    settings.important ? '!important' : ''\n                };\n                }`;\n                }\n            });\n        }\n\n        return css;\n    };\n\n    const updateStyle = () => setStyle(getStyle());\n\n    const lock = () => {\n        if (!status) {\n            setState();\n\n            updateStyle();\n\n            setStatus(true);\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollLock'));\n        }\n    };\n\n    const unlock = () => {\n        if (status) {\n            updateStyle();\n\n            window.scrollTo(state.scroll);\n\n            setStatus(false);\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollUnlock'));\n        }\n    };\n\n    const toggle = () => (!status ? lock() : unlock());\n\n    let timer = null;\n\n    window.addEventListener('resize', () => {\n        clearTimeout(timer);\n        \n        timer = setTimeout(() => {\n            if (status) {\n                unlock();\n\n                lock();\n            }\n        }, 500);\n    });\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: toggle,\n        isLocked: () => status,\n        setOptions: setOptions\n    };\n\n    return bodyScroll;\n\n})));\n"]}