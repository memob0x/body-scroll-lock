{"version":3,"sources":["body-scroll.mjs"],"names":["_objectSpread","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","global","factory","exports","module","define","amd","bodyScroll","html","document","documentElement","head","getElementsByTagName","ua","navigator","userAgent","isSafari","match","isSafariIOS","test","window","MSStream","BodyScrollEvent","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","Event","status","setStatus","bool","state","scroll","top","left","behavior","width","height","body","paddingRight","paddingBottom","scrollbars","y","x","settings","important","corrections","defaultCorrection","selector","property","inverted","supportedProperties","styler","id","element","querySelector","createElement","type","appendChild","updateStyle","$base","disabled","sheet","cssRules","insertRule","$scrollbar","deleteRule","$lock","$corrections","entry","gap","indexOf","factor","lock","vw","innerWidth","vh","innerHeight","_state","scrollTop","scrollLeft","scrollWidth","scrollHeight","clientWidth","clientHeight","setState","dispatchEvent","unlock","scrollTo","timer","addEventListener","clearTimeout","setTimeout","toggle","isLocked","setOptions","options","collection","collectionType","Array","isArray","entryType","push","setCorrections"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global.bodyScroll = factory());\n}(this, (function () { 'use strict';\n\n    const html = document.documentElement;\n    const head = document.head || document.getElementsByTagName('head')[0];\n\n    const ua = navigator.userAgent;\n    const isSafari = !!ua.match(/Version\\/[\\d\\.]+.*Safari/);\n    const isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;\n\n    const isSafariIOS = isIOS && isSafari;\n\n    const BodyScrollEvent = (() => {\n        if (typeof window.CustomEvent === 'function') {\n            return window.CustomEvent;\n        }\n\n        function CustomEvent(event, params) {\n            params = params || {\n                bubbles: false,\n                cancelable: false,\n                detail: undefined\n            };\n\n            const evt = document.createEvent('CustomEvent');\n\n            evt.initCustomEvent(\n                event,\n                params.bubbles,\n                params.cancelable,\n                params.detail\n            );\n\n            return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        return CustomEvent;\n    })();\n\n    let status = false;\n    const setStatus = (bool = true) => (status = bool);\n\n    let state = {\n        scroll: {\n            top: 0,\n            left: 0,\n            behavior: 'auto'\n        },\n        html: {\n            width: 'auto',\n            height: 'auto'\n        },\n        body: {\n            width: 'auto',\n            height: 'auto',\n            paddingRight: 0,\n            paddingBottom: 0 // not useful // TODO: check\n        },\n        scrollbars: {\n            y: 0,\n            x: 0\n        }\n    };\n\n    const setState = () => {\n        const vw = window.innerWidth;\n        const vh = window.innerHeight;\n\n        let _state = {\n            ...state,\n            ...{\n                scroll: {\n                    top: html.scrollTop,\n                    left: html.scrollLeft\n                }\n            }\n        };\n\n        if (isSafariIOS) {\n            _state.html = {\n                width: vw + _state.scroll.left, // - _state.scrollbars.y, // ios doesn't have scrollbars anyway...\n                height: vh + _state.scroll.top // - _state.scrollbars.x\n            };\n\n            _state.body = {\n                width: html.scrollWidth,\n                height: html.scrollHeight\n            };\n        } else {\n            const width = html.clientWidth;\n            const height = html.clientHeight;\n\n            _state.scrollbars = {\n                y: vw > width ? vw - width : 0,\n                x: vh > height ? vh - height : 0\n            };\n\n            _state.body.paddingRight = _state.scrollbars.y;\n            // _state.body.paddingBottom = _state.scrollbars.x; // not useful // TODO: check\n        }\n\n        state = _state;\n    };\n\n    let settings = {\n        important: true,\n        corrections: []\n    };\n\n    const defaultCorrection = {\n        selector: null,\n        property: 'margin-right',\n        inverted: false\n    };\n\n    const supportedProperties = [\n        'margin-right',\n        'margin-bottom',\n        'padding-right',\n        'padding-bottom',\n        'right',\n        'bottom'\n    ];\n\n    // TODO: put in setOptions\n    const setCorrections = (collection = []) => {\n        let corrections = [];\n\n        const collectionType = typeof collection;\n        if (\n            collectionType === 'string' ||\n            (!Array.isArray(collection) && collectionType === 'object')\n        ) {\n            collection = [collection];\n        }\n\n        collection.forEach(entry => {\n            if (entry) {\n                const entryType = typeof entry;\n\n                if (entryType === 'string') {\n                    corrections.push({\n                        ...defaultCorrection,\n                        ...{\n                            selector: entry\n                        }\n                    });\n                }\n\n                if (\n                    !Array.isArray(entry) &&\n                    entryType === 'object' &&\n                    entry.selector &&\n                    (!entry.property ||\n                        supportedProperties.indexOf(entry.property) > -1)\n                ) {\n                    corrections.push({\n                        ...defaultCorrection,\n                        ...entry\n                    });\n                }\n            }\n        });\n\n        return corrections;\n    };\n\n    const setOptions = (options = {}) => {\n        if (!status) {\n            settings = {\n                ...settings,\n                ...options\n            };\n            settings.corrections = setCorrections(settings.corrections);\n        }\n    };\n\n    const styler = id => {\n        id = `body-scroll-${id}`;\n\n        let element = head.querySelector(`style#${id}`);\n\n        if (!element) {\n            element = document.createElement('style');\n            element.type = 'text/css';\n            element.id = id;\n            head.appendChild(element);\n        }\n\n        return element;\n    };\n\n    const updateStyle = () => {\n        const important = settings.important ? '!important' : '';\n\n        const $base = styler('base');\n        $base.disabled = !status;\n        if (!$base.sheet.cssRules.length) {\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html,\n            body {\n                margin: 0${important};\n                min-width: auto${important};\n                min-height: auto${important};\n                max-width: none${important};\n                max-height: none${important};\n            }\n        `, 0);\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html {\n                padding: 0${important};\n            }\n        `, 1);\n        }\n\n        const $scrollbar = styler('scrollbar');\n        $scrollbar.disabled = !status;\n        if ($scrollbar.sheet.cssRules.length) {\n            $scrollbar.sheet.deleteRule(1);\n            $scrollbar.sheet.deleteRule(0);\n        }\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        html {\n            width: ${state.html.width}px${important};\n            height: ${state.html.height}px${important};\n        }\n    `, 0);\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        body{\n            width: ${state.body.width}px${important};\n            height: ${state.body.height}px${important};\n            padding: 0 ${state.body.paddingRight}px ${state.body.paddingBottom}px 0${important};\n        }\n    `, 1);\n\n        const $lock = styler('lock');\n        $lock.disabled = !status;\n        if (isSafariIOS) {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html,\n                body {\n                    overflow: visible${important};\n                }\n            `, 0);\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html {\n                    position: fixed${important};\n                }\n            `, 1);\n            } else {\n                $scrollbar.sheet.deleteRule(2);\n            }\n\n            // prettier-ignore\n            $lock.sheet.insertRule(`\n            html {\n                top: ${state.scroll.top * -1}px${important};\n                left: ${state.scroll.left * -1}px${important};\n            }\n        `, 2);\n        } else {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                body {\n                    overflow: hidden${important};\n                }\n            `, 0);\n            }\n        }\n\n        const corrections = settings.corrections;\n\n        if (corrections.length) {\n            const $corrections = styler('corrections');\n\n            // prettier-ignore\n            for(let i = $corrections.sheet.cssRules.length - 1; i >= 0; i-- ){\n                $corrections.sheet.deleteRule(i);\n            }\n\n            corrections.forEach(entry => {\n                const gap =\n                    state.scrollbars[\n                        entry.property.indexOf('right') > -1 ? 'y' : 'x'\n                    ];\n\n                if (gap > 0) {\n                    let factor = 1;\n\n                    if (!status) {\n                        factor = entry.inverted ? -1 : 0;\n                    }\n\n                    // prettier-ignore\n                    $corrections.sheet.insertRule(`\n                    ${entry.selector} {\n                        ${entry.property}: ${gap * factor}px${settings.important ? '!important' : ''};\n                    }\n                `);\n                }\n            });\n        }\n    };\n\n    const lock = () => {\n        if (!status) {\n            setStatus(true);\n\n            setState();\n\n            updateStyle();\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollLock'));\n        }\n    };\n\n    const unlock = () => {\n        if (status) {\n            setStatus(false);\n\n            updateStyle();\n\n            window.scrollTo(state.scroll);\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollUnlock'));\n        }\n    };\n\n    const toggle = () => (!status ? lock() : unlock());\n\n    let timer = null;\n\n    window.addEventListener('resize', () => {\n        clearTimeout(timer);\n        \n        timer = setTimeout(() => {\n            if (status) {\n                unlock();\n\n                lock();\n            }\n        }, 500);\n    });\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: toggle,\n        isLocked: () => status,\n        setOptions: setOptions\n    };\n\n    return bodyScroll;\n\n})));\n"],"file":"body-scroll.min.js"}