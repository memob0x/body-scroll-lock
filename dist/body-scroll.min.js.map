{"version":3,"sources":["body-scroll.mjs"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","global","factory","exports","module","define","amd","self","bodyScroll","$head","document","head","$html","documentElement","$body","body","$style","createElement","shouldUsePositionFixedTechnique","userAgent","arguments","length","undefined","window","navigator","platform","maxTouchPoints","test","isAppleTouchDevice","scrollPosition","x","y","scrollbarWidth","clientWidth","options","alwaysUsePositionFixedTechnique","isStyleElementInHead","parentNode","insertIndexedRule","rule","index","appendChild","sheet","cssRules","deleteRule","insertRule","insertResizableRules","concat","resizeListener","isLocked","disabled","lock","scrollX","scrollY","_clientWidth","style","width","overflow","scroll","dispatchEvent","CustomEvent","detail","addEventListener","unlock","removeEventListener","toggle","setOption","name","value"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global = global || self, global.bodyScroll = factory());\n}(this, function () { 'use strict';\n\n    // elements involved\n    const $head = document.head;\n    const $html = document.documentElement;\n    const $body = document.body;\n    const $style = document.createElement(\"style\");\n\n    /**\n     * Apple devices recognizer\n     * @param {string} userAgent The browser user agent\n     * @param {string} platform The device platform (eg. window.navigator.platform)\n     * @param {number} maxTouchPoints The device maximum touch points supported\n     * @returns {boolean} True if is an apple touch device\n     */\n    const isAppleTouchDevice = (\n        userAgent = window.navigator.userAgent,\n        platform = window.navigator.platform,\n        maxTouchPoints = window.navigator.maxTouchPoints\n    ) => {\n        const isLegacyIOS = /iPad|iPhone|iPod/.test(userAgent);\n        const isMultiTouchMacAkaIOS13 =\n            platform === \"MacIntel\" && maxTouchPoints > 1;\n        return isLegacyIOS || isMultiTouchMacAkaIOS13;\n    };\n\n    const shouldUsePositionFixedTechnique = isAppleTouchDevice();\n\n    let scrollPosition = {\n        x: 0,\n        y: 0\n    };\n    let scrollbarWidth = 0;\n    let clientWidth = 0;\n\n    let options = {\n        alwaysUsePositionFixedTechnique: false\n    };\n\n    /**\n     * Checks if the style element is in the tag head or not\n     * @returns {boolean} true if present\n     */\n    const isStyleElementInHead = () => $style.parentNode === $head;\n\n    /**\n     * Inserts a rule with the CSSStyleSheet interface\n     * @param {string} rule The CSS rule to add\n     * @param {number} index The index of the CSS rule in the CSSRulesList\n     */\n    const insertIndexedRule = (rule = \"\", index = 0) => {\n        if (!isStyleElementInHead()) {\n            $head.appendChild($style);\n        }\n\n        if ($style.sheet.cssRules[index]) {\n            $style.sheet.deleteRule(index);\n        }\n\n        $style.sheet.insertRule(rule, index);\n    };\n\n    /**\n     * Inserts the CSS rules that doesn't need to be recalculated on resize\n     */\n    const insertBaseRules = () => {\n        insertIndexedRule(\n            `html, body {\n            height: auto!important;\n            margin: 0!important;\n            padding: 0 ${scrollbarWidth}px 0 0!important;\n        }`,\n            0\n        );\n\n        if (\n            shouldUsePositionFixedTechnique ||\n            options.alwaysUsePositionFixedTechnique\n        ) {\n            insertIndexedRule(\n                `html {\n                position: fixed!important;\n                top: ${-1 * scrollPosition.y}px!important;\n                left: ${-1 * scrollPosition.x}px!important;\n                overflow: visible!important;\n            }`,\n                1\n            );\n        } else {\n            insertIndexedRule(\n                `body {\n                overflow: hidden!important;\n            }`,\n                1\n            );\n        }\n    };\n\n    /**\n     * Inserts the CSS rules that need to be recalculated on resize\n     */\n    const insertResizableRules = () =>\n        insertIndexedRule(\n            `html, body {\n            width: ${clientWidth}px!important;\n        }`,\n            2\n        );\n\n    /**\n     *\n     */\n    const resizeListener = () => {\n        clientWidth = $html.clientWidth;\n\n        insertResizableRules();\n    };\n\n    /**\n     * Returns whether the body scroll is locked or not\n     * @returns {boolean} The body scroll lock state\n     */\n    const isLocked = () => isStyleElementInHead() && !$style.disabled;\n\n    /**\n     * Locks the body scroll\n     * @returns {boolean} Whether the lock action has been successful of not (false if already locked)\n     */\n    const lock = () => {\n        if (isLocked()) {\n            return false;\n        }\n\n        if (\n            shouldUsePositionFixedTechnique ||\n            options.alwaysUsePositionFixedTechnique\n        ) {\n            scrollPosition = {\n                x: window.scrollX,\n                y: window.scrollY\n            };\n        }\n\n        const _clientWidth = $html.clientWidth;\n        $body.style.width = $body.clientWidth + \"px\";\n        $html.style.overflow = \"hidden\";\n        clientWidth = $html.clientWidth;\n        scrollbarWidth = clientWidth - _clientWidth;\n        $body.style.width = \"\";\n        $html.style.overflow = \"\";\n\n        insertBaseRules();\n        insertResizableRules();\n\n        $style.disabled = false;\n\n        if (\n            shouldUsePositionFixedTechnique ||\n            options.alwaysUsePositionFixedTechnique\n        ) {\n            window.scroll(0, 0);\n        }\n\n        window.dispatchEvent(\n            new CustomEvent(\"bodyScrollLock\", {\n                detail: {\n                    clientWidth: clientWidth,\n                    scrollbarWidth: scrollbarWidth\n                }\n            })\n        );\n\n        window.addEventListener(\"resize\", resizeListener);\n\n        return true;\n    };\n\n    /**\n     * Unlocks the body scroll\n     * @returns {boolean} Whether the unlock action has been successful of not (false if already unlocked)\n     */\n    const unlock = () => {\n        if (!isLocked()) {\n            return false;\n        }\n\n        $style.disabled = true;\n\n        if (\n            shouldUsePositionFixedTechnique ||\n            options.alwaysUsePositionFixedTechnique\n        ) {\n            window.scroll(scrollPosition.x, scrollPosition.y);\n        }\n\n        window.dispatchEvent(\n            new CustomEvent(\"bodyScrollUnlock\", {\n                detail: {\n                    clientWidth: clientWidth,\n                    scrollbarWidth: scrollbarWidth\n                }\n            })\n        );\n\n        window.removeEventListener(\"resize\", resizeListener);\n\n        return true;\n    };\n\n    const setOption = (name, value) => {\n        if (name in options && typeof value === typeof options[name]) {\n            options[name] = value;\n        }\n    };\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: () => (!isLocked() ? lock() : unlock()),\n        isLocked: isLocked,\n        setOption: setOption\n    };\n\n    return bodyScroll;\n\n}));\n"],"file":"body-scroll.min.js"}