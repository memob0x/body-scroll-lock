{"version":3,"sources":["body-scroll.mjs"],"names":["_objectSpread","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","global","factory","exports","module","define","amd","bodyScroll","html","document","documentElement","head","getElementsByTagName","ua","navigator","userAgent","isSafari","match","isSafariIOS","test","window","MSStream","BodyScrollEvent","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","Event","status","setStatus","bool","state","scroll","top","left","width","height","body","paddingRight","paddingBottom","scrollbars","y","x","settings","important","corrections","defaultCorrection","selector","property","inverted","supportedProperties","setSettings","options","collection","collectionType","Array","isArray","entry","entryType","push","indexOf","setCorrections","styler","id","element","querySelector","createElement","type","appendChild","updateStyle","$base","disabled","sheet","cssRules","insertRule","$scrollbar","deleteRule","$lock","$corrections","_i","gap","factor","lock","vw","innerWidth","vh","innerHeight","_state","scrollTop","scrollLeft","scrollWidth","scrollHeight","clientWidth","clientHeight","setState","dispatchEvent","unlock","resizeTimer","addEventListener","clearTimeout","setTimeout","toggle","isLocked","setOptions"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global.bodyScroll = factory());\n}(this, (function () { 'use strict';\n\n    const html = document.documentElement;\r\n    const head = document.head || document.getElementsByTagName('head')[0];\r\n\r\n    const ua = navigator.userAgent;\r\n    const isSafari = !!ua.match(/Version\\/[\\d\\.]+.*Safari/);\r\n    const isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;\r\n\r\n    const isSafariIOS = isIOS && isSafari;\r\n\r\n    const BodyScrollEvent = (() => {\r\n        if (typeof window.CustomEvent === 'function') {\r\n            return window.CustomEvent;\r\n        }\r\n\r\n        function CustomEvent(event, params) {\r\n            params = params || {\r\n                bubbles: false,\r\n                cancelable: false,\r\n                detail: undefined\r\n            };\r\n\r\n            const evt = document.createEvent('CustomEvent');\r\n\r\n            evt.initCustomEvent(\r\n                event,\r\n                params.bubbles,\r\n                params.cancelable,\r\n                params.detail\r\n            );\r\n\r\n            return evt;\r\n        }\r\n\r\n        CustomEvent.prototype = window.Event.prototype;\r\n\r\n        return CustomEvent;\r\n    })();\n\n    let status = false;\r\n    const setStatus = (bool = true) => (status = bool);\n\n    // TODO: cleanup!\r\n\r\n    let state = {\r\n        scroll: {\r\n            top: 0,\r\n            left: 0\r\n        },\r\n        html: {\r\n            width: 'auto',\r\n            height: 'auto'\r\n        },\r\n        body: {\r\n            width: 'auto',\r\n            height: 'auto',\r\n            paddingRight: 0,\r\n            paddingBottom: 0 // not useful // TODO: check\r\n        },\r\n        scrollbars: {\r\n            y: 0,\r\n            x: 0\r\n        }\r\n    };\r\n\r\n    const setState = () => {\r\n        const vw = window.innerWidth;\r\n        const vh = window.innerHeight;\r\n\r\n        let _state = {\r\n            ...state,\r\n            ...{\r\n                scroll: {\r\n                    top: html.scrollTop,\r\n                    left: html.scrollLeft\r\n                }\r\n            }\r\n        };\r\n\r\n        if (isSafariIOS) {\r\n            _state.html = {\r\n                width: vw + _state.scroll.left, // - _state.scrollbars.y, // ios doesn't have scrollbars anyway...\r\n                height: vh + _state.scroll.top // - _state.scrollbars.x\r\n            };\r\n\r\n            _state.body = {\r\n                width: html.scrollWidth,\r\n                height: html.scrollHeight\r\n            };\r\n        } else {\r\n            const width = html.clientWidth;\r\n            const height = html.clientHeight;\r\n\r\n            _state.scrollbars = {\r\n                y: vw > width ? vw - width : 0,\r\n                x: vh > height ? vh - height : 0\r\n            };\r\n\r\n            _state.body.paddingRight = _state.scrollbars.y;\r\n            // _state.body.paddingBottom = _state.scrollbars.x; // not useful // TODO: check\r\n        }\r\n\r\n        state = _state;\r\n    };\n\n    let settings = {\r\n        important: true,\r\n        corrections: []\r\n    };\r\n\r\n    const defaultCorrection = {\r\n        selector: null,\r\n        property: 'margin-right',\r\n        inverted: false\r\n    };\r\n\r\n    const supportedProperties = [\r\n        'margin-right',\r\n        'margin-bottom',\r\n        'padding-right',\r\n        'padding-bottom',\r\n        'right',\r\n        'bottom'\r\n    ];\r\n\r\n    const setCorrections = (collection = []) => {\r\n        let corrections = [];\r\n\r\n        const collectionType = typeof collection;\r\n        if (\r\n            collectionType === 'string' ||\r\n            (!Array.isArray(collection) && collectionType === 'object')\r\n        ) {\r\n            collection = [collection];\r\n        }\r\n\r\n        collection.forEach(entry => {\r\n            if (entry) {\r\n                const entryType = typeof entry;\r\n\r\n                if (entryType === 'string') {\r\n                    corrections.push({\r\n                        ...defaultCorrection,\r\n                        ...{\r\n                            selector: entry\r\n                        }\r\n                    });\r\n                }\r\n\r\n                if (\r\n                    !Array.isArray(entry) &&\r\n                    entryType === 'object' &&\r\n                    entry.selector &&\r\n                    (!entry.property ||\r\n                        supportedProperties.indexOf(entry.property) > -1)\r\n                ) {\r\n                    corrections.push({\r\n                        ...defaultCorrection,\r\n                        ...entry\r\n                    });\r\n                }\r\n            }\r\n        });\r\n\r\n        return corrections;\r\n    };\r\n\r\n    const setSettings = (options = {}) => {\r\n        settings = {\r\n            ...settings,\r\n            ...options\r\n        };\r\n\r\n        settings.corrections = setCorrections(settings.corrections);\r\n    };\n\n    const styler = id => {\n        id = `body-scroll__${id}`;\n\n        let element = head.querySelector(`style#${id}`);\n\n        if (!element) {\n            element = document.createElement('style');\n            element.type = 'text/css';\n            element.id = id;\n            head.appendChild(element);\n        }\n\n        return element;\n    };\n\n    const updateStyle = () => {\n        const important = settings.important ? '!important' : '';\n\n        const $base = styler('base');\n        $base.disabled = !status;\n        if (!$base.sheet.cssRules.length) {\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html,\n            body {\n                margin: 0${important};\n                min-width: auto${important};\n                min-height: auto${important};\n                max-width: none${important};\n                max-height: none${important};\n            }\n        `, 0);\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html {\n                padding: 0${important};\n            }\n        `, 1);\n        }\n\n        const $scrollbar = styler('bar');\n        $scrollbar.disabled = !status;\n        if ($scrollbar.sheet.cssRules.length) {\n            $scrollbar.sheet.deleteRule(1);\n            $scrollbar.sheet.deleteRule(0);\n        }\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        html {\n            width: ${state.html.width}px${important};\n            height: ${state.html.height}px${important};\n        }\n    `, 0);\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        body{\n            width: ${state.body.width}px${important};\n            height: ${state.body.height}px${important};\n            padding: 0 ${state.body.paddingRight}px ${state.body.paddingBottom}px 0${important};\n        }\n    `, 1);\n\n        const $lock = styler('lock');\n        $lock.disabled = !status;\n        if (isSafariIOS) {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html,\n                body {\n                    overflow: visible${important};\n                }\n            `, 0);\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html {\n                    position: fixed${important};\n                }\n            `, 1);\n            } else {\n                $lock.sheet.deleteRule(2);\n            }\n\n            // prettier-ignore\n            $lock.sheet.insertRule(`\n            html {\n                top: ${state.scroll.top * -1}px${important};\n                left: ${state.scroll.left * -1}px${important};\n            }\n        `, 2);\n        } else {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                body {\n                    overflow: hidden${important};\n                }\n            `, 0);\n            }\n        }\n\n        const corrections = settings.corrections;\n        const $corrections = styler('corrections');\n\n        // prettier-ignore\n        for (let i = $corrections.sheet.cssRules.length - 1; i >= 0; i--) {\n            $corrections.sheet.deleteRule(i);\n        }\n\n        let i = 0;\n        corrections.forEach(entry => {\n            // prettier-ignore\n            const gap = state.scrollbars[entry.property.indexOf('right') > -1 ? 'y' : 'x'];\n\n            if (gap > 0) {\n                let factor = 1;\n\n                if (!status) {\n                    factor = entry.inverted ? -1 : 0;\n                }\n\n                // prettier-ignore\n                $corrections.sheet.insertRule(`\n                ${entry.selector} {\n                    ${entry.property}: ${gap * factor}px${settings.important ? '!important' : ''};\n                }\n            `, i);\n\n                i++;\n            }\n        });\n    };\n\n    const lock = () => {\r\n        if (!status) {\r\n            setStatus(true);\r\n\r\n            setState();\r\n\r\n            updateStyle();\r\n\r\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollLock'));\r\n        }\r\n    };\n\n    const unlock = () => {\r\n        if (status) {\r\n            setStatus(false);\r\n\r\n            updateStyle();\r\n\r\n            html.scrollTop = state.scroll.top;\r\n            html.scrollLeft = state.scroll.left;\r\n\r\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollUnlock'));\r\n        }\r\n    };\n\n    let resizeTimer = null;\n    window.addEventListener('resize', () => {\n        clearTimeout(resizeTimer);\n\n        resizeTimer = setTimeout(() => updateStyle(), 500);\n    });\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: () => (!status ? lock() : unlock()),\n        isLocked: () => status,\n        setOptions: (options = {}) => {\n            setSettings(options);\n\n            updateStyle();\n        }\n    };\n\n    return bodyScroll;\n\n})));\n"],"file":"body-scroll.min.js"}