{"version":3,"sources":["body-scroll.mjs"],"names":["_objectSpread","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","global","factory","exports","module","define","amd","bodyScroll","html","document","documentElement","head","getElementsByTagName","ua","navigator","userAgent","isSafari","match","isSafariIOS","test","window","MSStream","BodyScrollEvent","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","Event","status","setStatus","bool","state","scroll","top","left","height","body","paddingRight","bars","x","y","settings","important","corrections","defaultCorrection","selector","property","inverted","supportedProperties","setSettings","options","collection","collectionType","Array","isArray","entry","entryType","push","indexOf","setCorrections","styler","id","element","querySelector","createElement","type","appendChild","updateStyle","$base","disabled","sheet","cssRules","insertRule","$scrollbar","deleteRule","$lock","$corrections","_i","gap","factor","lock","vw","vh","width","_state","innerWidth","innerHeight","clientWidth","clientHeight","scrollTop","scrollLeft","scrollHeight","dispatchEvent","unlock","resizeTimer","addEventListener","clearTimeout","setTimeout","toggle","isLocked","setOptions"],"mappings":"AAAA,aAEA,SAASA,cAAcC,GAAU,IAAK,IAAIC,EAAI,EAAGA,EAAIC,UAAUC,OAAQF,IAAK,CAAE,IAAIG,EAAyB,MAAhBF,UAAUD,GAAaC,UAAUD,GAAK,GAAQI,EAAUC,OAAOC,KAAKH,GAAqD,mBAAjCE,OAAOE,wBAAwCH,EAAUA,EAAQI,OAAOH,OAAOE,sBAAsBJ,GAAQM,OAAO,SAAUC,GAAO,OAAOL,OAAOM,yBAAyBR,EAAQO,GAAKE,eAAmBR,EAAQS,QAAQ,SAAUC,GAAOC,gBAAgBhB,EAAQe,EAAKX,EAAOW,MAAa,OAAOf,EAExd,SAASgB,gBAAgBC,EAAKF,EAAKG,GAAiK,OAApJH,KAAOE,EAAOX,OAAOa,eAAeF,EAAKF,EAAK,CAAEG,MAAOA,EAAOL,YAAY,EAAMO,cAAc,EAAMC,UAAU,IAAkBJ,EAAIF,GAAOG,EAAgBD,EAE3M,SAASK,QAAQL,GAAwT,OAAtOK,QAArD,mBAAXC,QAAoD,iBAApBA,OAAOC,SAAmC,SAAiBP,GAAO,cAAcA,GAA2B,SAAiBA,GAAO,OAAOA,GAAyB,mBAAXM,QAAyBN,EAAIQ,cAAgBF,QAAUN,IAAQM,OAAOG,UAAY,gBAAkBT,IAAyBA,IAExV,SAAWU,EAAQC,GACqD,YAAlD,oBAAZC,QAA0B,YAAcP,QAAQO,WAA4C,oBAAXC,OAAyBA,OAAOD,QAAUD,IAA8B,mBAAXG,QAAyBA,OAAOC,IAAMD,OAAO,aAAcH,SAChN,GADkOK,WAAaL,IADlP,CAEG,EAAQ,WAGT,IAAIM,EAAOC,SAASC,gBAChBC,EAAOF,SAASE,MAAQF,SAASG,qBAAqB,QAAQ,GAC9DC,EAAKC,UAAUC,UACfC,IAAaH,EAAGI,MAAM,4BAEtBC,EADQ,mBAAmBC,KAAKN,KAAQO,OAAOC,UACxBL,EAEvBM,EAAkB,WACpB,GAAkC,mBAAvBF,OAAOG,YAChB,OAAOH,OAAOG,YAGhB,SAASA,EAAYC,EAAOC,GAC1BA,EAASA,GAAU,CACjBC,SAAS,EACTC,YAAY,EACZC,YAAQC,GAEV,IAAIC,EAAMrB,SAASsB,YAAY,eAE/B,OADAD,EAAIE,gBAAgBR,EAAOC,EAAOC,QAASD,EAAOE,WAAYF,EAAOG,QAC9DE,EAIT,OADAP,EAAYvB,UAAYoB,OAAOa,MAAMjC,UAC9BuB,EAjBa,GAoBlBW,GAAS,EAETC,EAAY,WACd,IAAIC,IAAO5D,UAAUC,OAAS,QAAsBoD,IAAjBrD,UAAU,KAAmBA,UAAU,GAC1E,OAAO0D,EAASE,GAGdC,EAAQ,CACVC,OAAQ,CACNC,IAAK,EACLC,KAAM,GAERhC,KAAM,CACJiC,OAAQ,QAEVC,KAAM,CACJD,OAAQ,OACRE,aAAc,GAEhBC,KAAM,CACJC,EAAG,EACHC,EAAG,IA8BHC,EAAW,CACbC,WAAW,EACXC,YAAa,IAEXC,EAAoB,CACtBC,SAAU,KACVC,SAAU,eACVC,UAAU,GAERC,EAAsB,CAAC,eAAgB,gBAAiB,gBAAiB,iBAAkB,QAAS,UA8BpGC,EAAc,WAChB,IAAIC,EAAUhF,UAAUC,OAAS,QAAsBoD,IAAjBrD,UAAU,GAAmBA,UAAU,GAAK,IAClFuE,EAAW1E,cAAc,GAAI0E,EAAUS,IAC9BP,YA/BU,WACnB,IAAIQ,EAAajF,UAAUC,OAAS,QAAsBoD,IAAjBrD,UAAU,GAAmBA,UAAU,GAAK,GACjFyE,EAAc,GAEdS,EAAiB9D,QAAQ6D,GAqB7B,OAnBuB,WAAnBC,IAAgCC,MAAMC,QAAQH,IAAkC,WAAnBC,KAC/DD,EAAa,CAACA,IAGhBA,EAAWrE,QAAQ,SAAUyE,GAC3B,GAAIA,EAAO,CACT,IAAIC,EAAYlE,QAAQiE,GAEN,WAAdC,GACFb,EAAYc,KAAK1F,cAAc,GAAI6E,EAAmB,CACpDC,SAAUU,MAITF,MAAMC,QAAQC,IAAwB,WAAdC,GAA0BD,EAAMV,UAA+B,SAAnBU,EAAMV,UAA0C,SAAnBU,EAAMV,YAAyBU,EAAMT,UAAYE,EAAoBU,QAAQH,EAAMT,WAAa,IACpMH,EAAYc,KAAK1F,cAAc,GAAI6E,EAAmBW,OAIrDZ,EAMgBgB,CAAelB,EAASE,cAG7CiB,EAAS,SAAgBC,GAC3BA,EAAK,gBAAgBpF,OAAOoF,GAC5B,IAAIC,EAAUzD,EAAK0D,cAAc,SAAStF,OAAOoF,IASjD,OAPKC,KACHA,EAAU3D,SAAS6D,cAAc,UACzBC,KAAO,WACfH,EAAQD,GAAKA,EACbxD,EAAK6D,YAAYJ,IAGZA,GAGLK,EAAc,WAChB,IAAIzB,EAAYD,EAASC,UAAY,aAAe,GAChD0B,EAAQR,EAAO,QACnBQ,EAAMC,UAAYzC,EAEbwC,EAAME,MAAMC,SAASpG,SACxBiG,EAAME,MAAME,WAAW,qEAAqE/F,OAAOiE,EAAW,sCAAsCjE,OAAOiE,EAAW,uCAAuCjE,OAAOiE,EAAW,sCAAsCjE,OAAOiE,EAAW,uCAAuCjE,OAAOiE,EAAW,kCAAkCjE,OAAOiE,EAAW,8BAA+B,GACna0B,EAAME,MAAME,WAAW,mDAAmD/F,OAAOiE,EAAW,8BAA+B,IAG7H,IAAI+B,EAAab,EAAO,OACxBa,EAAWJ,UAAYzC,EAEnB6C,EAAWH,MAAMC,SAASpG,SAC5BsG,EAAWH,MAAMI,WAAW,GAC5BD,EAAWH,MAAMI,WAAW,IAG9BD,EAAWH,MAAME,WAAW,yCAAyC/F,OAAOsD,EAAM7B,KAAKiC,OAAQ,MAAM1D,OAAOiE,EAAW,sBAAuB,GAC9I+B,EAAWH,MAAME,WAAW,wCAAwC/F,OAAOsD,EAAMK,KAAKD,OAAQ,MAAM1D,OAAOiE,EAAW,8BAA8BjE,OAAOsD,EAAMK,KAAKC,aAAc,UAAU5D,OAAOiE,EAAW,sBAAuB,GACvO,IAAIiC,EAAQf,EAAO,QACnBe,EAAMN,UAAYzC,EAEdhB,GACG+D,EAAML,MAAMC,SAASpG,OAIxBwG,EAAML,MAAMI,WAAW,IAHvBC,EAAML,MAAME,WAAW,yFAAyF/F,OAAOiE,EAAW,sCAAuC,GACzKiC,EAAML,MAAME,WAAW,gEAAgE/F,OAAOiE,EAAW,sCAAuC,IAKlJiC,EAAML,MAAME,WAAW,8CAA8C/F,QAA2B,EAApBsD,EAAMC,OAAOC,IAAU,MAAMxD,OAAOiE,EAAW,6BAA6BjE,QAA4B,EAArBsD,EAAMC,OAAOE,KAAW,MAAMzD,OAAOiE,EAAW,8BAA+B,IAEzOiC,EAAML,MAAMC,SAASpG,QACxBwG,EAAML,MAAME,WAAW,iEAAiE/F,OAAOiE,EAAW,sCAAuC,GAOrJ,IAHA,IAAIC,EAAcF,EAASE,YACvBiC,EAAehB,EAAO,eAEjBiB,EAAKD,EAAaN,MAAMC,SAASpG,OAAS,EAAG0G,GAAM,EAAGA,IAC7DD,EAAaN,MAAMI,WAAWG,GAGhC,IAAI5G,EAAI,EACR0E,EAAY7D,QAAQ,SAAUyE,GAC5B,IAAIuB,EAAM/C,EAAMO,KAAKiB,EAAMT,SAASY,QAAQ,UAAY,EAAI,IAAM,KAElE,GAAIoB,EAAM,EAAG,CACX,IAAIC,EAAS,EAERnD,IACHmD,EAASxB,EAAMR,UAAY,EAAI,GAGjC6B,EAAaN,MAAME,WAAW,qBAAqB/F,OAAO8E,EAAMV,SAAU,4BAA4BpE,OAAO8E,EAAMT,SAAU,MAAMrE,OAAOqG,EAAMC,EAAQ,MAAMtG,OAAOgE,EAASC,UAAY,aAAe,GAAI,sCAAuCzE,GACpPA,QAKF+G,EAAO,WAnJI,IACTC,EACAC,EACAC,EACAhD,EAEAiD,EA8ICxD,IACHC,GAAU,GApJRoD,EAAKnE,OAAOuE,WACZH,EAAKpE,OAAOwE,YACZH,EAAQjF,EAAKqF,YACbpD,EAASjC,EAAKsF,aAEdJ,EAASrH,cAAc,GAAIgE,EAAO,CACpCC,OAAQ,CACNC,IAAK/B,EAAKuF,UACVvD,KAAMhC,EAAKwF,YAEbpD,KAAM,CACJE,EAAGyC,EAAKE,EAAQF,EAAKE,EAAQ,EAC7B5C,EAAG2C,EAAK/C,EAAS+C,EAAK/C,EAAS,KAI/BvB,IACFwE,EAAOlF,KAAKiC,OAAS+C,EAAKE,EAAOpD,OAAOC,IACxCmD,EAAOhD,KAAKD,OAASjC,EAAKyF,cAG5BP,EAAOhD,KAAKC,aAAe+C,EAAO9C,KAAKE,EACvCT,EAAQqD,EAgINjB,IACArD,OAAO8E,cAAc,IAAI5E,EAAgB,qBAIzC6E,EAAS,WACPjE,IACFC,GAAU,GACVsC,IACAjE,EAAKuF,UAAY1D,EAAMC,OAAOC,IAC9B/B,EAAKwF,WAAa3D,EAAMC,OAAOE,KAC/BpB,OAAO8E,cAAc,IAAI5E,EAAgB,uBAIzC8E,EAAc,KAsBlB,OArBAhF,OAAOiF,iBAAiB,SAAU,WAChCC,aAAaF,GACbA,EAAcG,WAAW,WACvB,OAAO9B,KACN,OAEY,CACfa,KAAMA,EACNa,OAAQA,EACRK,OAAQ,WACN,OAAQtE,EAAkBiE,IAATb,KAEnBmB,SAAU,WACR,OAAOvE,GAETwE,WAAY,WACV,IAAIlD,EAAUhF,UAAUC,OAAS,QAAsBoD,IAAjBrD,UAAU,GAAmBA,UAAU,GAAK,GAClF+E,EAAYC,GACZiB","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global.bodyScroll = factory());\n}(this, (function () { 'use strict';\n\n    const html = document.documentElement;\n    const head = document.head || document.getElementsByTagName('head')[0];\n\n    const ua = navigator.userAgent;\n    const isSafari = !!ua.match(/Version\\/[\\d\\.]+.*Safari/);\n    const isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;\n\n    const isSafariIOS = isIOS && isSafari;\n\n    const BodyScrollEvent = (() => {\n        if (typeof window.CustomEvent === 'function') {\n            return window.CustomEvent;\n        }\n\n        function CustomEvent(event, params) {\n            params = params || {\n                bubbles: false,\n                cancelable: false,\n                detail: undefined\n            };\n\n            const evt = document.createEvent('CustomEvent');\n\n            evt.initCustomEvent(\n                event,\n                params.bubbles,\n                params.cancelable,\n                params.detail\n            );\n\n            return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        return CustomEvent;\n    })();\n\n    let status = false;\n    const setStatus = (bool = true) => (status = bool);\n\n    // TODO: cleanup!\n\n    let state = {\n        scroll: {\n            top: 0,\n            left: 0\n        },\n        html: {\n            height: 'auto'\n        },\n        body: {\n            height: 'auto',\n            paddingRight: 0\n        },\n        bars: {\n            x: 0,\n            y: 0\n        }\n    };\n\n    const setState = () => {\n        const vw = window.innerWidth;\n        const vh = window.innerHeight;\n        const width = html.clientWidth;\n        const height = html.clientHeight;\n\n        let _state = {\n            ...state,\n            ...{\n                scroll: {\n                    top: html.scrollTop,\n                    left: html.scrollLeft\n                },\n                bars: {\n                    y: vw > width ? vw - width : 0,\n                    x: vh > height ? vh - height : 0\n                }\n            }\n        };\n\n        if (isSafariIOS) {\n            _state.html.height = vh + _state.scroll.top;\n            _state.body.height = html.scrollHeight;\n        }\n\n        _state.body.paddingRight = _state.bars.y;\n\n        state = _state;\n    };\n\n    let settings = {\n        important: true,\n        corrections: []\n    };\n\n    const defaultCorrection = {\n        selector: null,\n        property: 'margin-right',\n        inverted: false\n    };\n\n    const supportedProperties = [\n        'margin-right',\n        'margin-bottom',\n        'padding-right',\n        'padding-bottom',\n        'right',\n        'bottom'\n    ];\n\n    const setCorrections = (collection = []) => {\n        let corrections = [];\n        const collectionType = typeof collection;\n\n        // prettier-ignore\n        if ( collectionType === 'string' || ( !Array.isArray(collection) && collectionType === 'object' ) ) {\n            collection = [collection];\n        }\n\n        collection.forEach(entry => {\n            if (entry) {\n                const entryType = typeof entry;\n\n                if (entryType === 'string') {\n                    // prettier-ignore\n                    corrections.push({ ...defaultCorrection, ...{ selector: entry } });\n                }\n\n                // prettier-ignore\n                if (\n                    !Array.isArray(entry) && entryType === 'object' &&\n                    entry.selector &&\n                    entry.selector !== 'body' &&\n                    entry.selector !== 'html' && (\n                        !entry.property || supportedProperties.indexOf(entry.property) > -1\n                    )\n                ) {\n                    corrections.push({ ...defaultCorrection, ...entry });\n                }\n            }\n        });\n\n        return corrections;\n    };\n\n    const setSettings = (options = {}) => {\n        settings = {\n            ...settings,\n            ...options\n        };\n\n        settings.corrections = setCorrections(settings.corrections);\n    };\n\n    const styler = id => {\n        id = `body-scroll__${id}`;\n\n        let element = head.querySelector(`style#${id}`);\n\n        if (!element) {\n            element = document.createElement('style');\n            element.type = 'text/css';\n            element.id = id;\n            head.appendChild(element);\n        }\n\n        return element;\n    };\n\n    const updateStyle = () => {\n        const important = settings.important ? '!important' : '';\n\n        const $base = styler('base');\n        $base.disabled = !status;\n        if (!$base.sheet.cssRules.length) {\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html,\n            body {\n                margin: 0${important};\n                min-width: auto${important};\n                min-height: auto${important};\n                max-width: none${important};\n                max-height: none${important};\n                width: auto${important};\n            }\n        `, 0);\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html {\n                padding: 0${important};\n            }\n        `, 1);\n        }\n\n        const $scrollbar = styler('bar');\n        $scrollbar.disabled = !status;\n        if ($scrollbar.sheet.cssRules.length) {\n            $scrollbar.sheet.deleteRule(1);\n            $scrollbar.sheet.deleteRule(0);\n        }\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        html {\n            height: ${state.html.height}px${important};\n        }\n    `, 0);\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        body{\n            height: ${state.body.height}px${important};\n            padding: 0 ${state.body.paddingRight}px 0 0${important};\n        }\n    `, 1);\n\n        const $lock = styler('lock');\n        $lock.disabled = !status;\n        if (isSafariIOS) {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html,\n                body {\n                    overflow: visible${important};\n                }\n            `, 0);\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html {\n                    position: fixed${important};\n                }\n            `, 1);\n            } else {\n                $lock.sheet.deleteRule(2);\n            }\n\n            // prettier-ignore\n            $lock.sheet.insertRule(`\n            html {\n                top: ${state.scroll.top * -1}px${important};\n                left: ${state.scroll.left * -1}px${important};\n            }\n        `, 2);\n        } else {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                body {\n                    overflow: hidden${important};\n                }\n            `, 0);\n            }\n        }\n\n        const corrections = settings.corrections;\n        const $corrections = styler('corrections');\n\n        // prettier-ignore\n        for (let i = $corrections.sheet.cssRules.length - 1; i >= 0; i--) {\n            $corrections.sheet.deleteRule(i);\n        }\n\n        let i = 0;\n        corrections.forEach(entry => {\n            // prettier-ignore\n            const gap = state.bars[entry.property.indexOf('right') > -1 ? 'y' : 'x'];\n\n            if (gap > 0) {\n                let factor = 1;\n\n                if (!status) {\n                    factor = entry.inverted ? -1 : 0;\n                }\n\n                // prettier-ignore\n                $corrections.sheet.insertRule(`\n                ${entry.selector} {\n                    ${entry.property}: ${gap * factor}px${settings.important ? '!important' : ''};\n                }\n            `, i);\n\n                i++;\n            }\n        });\n    };\n\n    const lock = () => {\n        if (!status) {\n            setStatus(true);\n\n            setState();\n\n            updateStyle();\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollLock'));\n        }\n    };\n\n    const unlock = () => {\n        if (status) {\n            setStatus(false);\n\n            updateStyle();\n\n            html.scrollTop = state.scroll.top;\n            html.scrollLeft = state.scroll.left;\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollUnlock'));\n        }\n    };\n\n    let resizeTimer = null;\n    window.addEventListener('resize', () => {\n        clearTimeout(resizeTimer);\n\n        resizeTimer = setTimeout(() => updateStyle(), 500);\n    });\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: () => (!status ? lock() : unlock()),\n        isLocked: () => status,\n        setOptions: (options = {}) => {\n            setSettings(options);\n\n            updateStyle();\n        }\n    };\n\n    return bodyScroll;\n\n})));\n"],"file":"body-scroll.min.js"}