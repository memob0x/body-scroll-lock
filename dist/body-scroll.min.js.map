{"version":3,"sources":["body-scroll.mjs"],"names":["_objectSpread","target","i","arguments","length","source","ownKeys","Object","keys","getOwnPropertySymbols","concat","filter","sym","getOwnPropertyDescriptor","enumerable","forEach","key","_defineProperty","obj","value","defineProperty","configurable","writable","_typeof","Symbol","iterator","constructor","prototype","global","factory","exports","module","define","amd","bodyScroll","html","document","documentElement","head","getElementsByTagName","ua","navigator","userAgent","isSafari","match","isSafariIOS","test","window","MSStream","BodyScrollEvent","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","Event","status","setStatus","bool","state","scroll","top","left","width","height","body","paddingRight","paddingBottom","scrollbars","y","x","settings","important","corrections","defaultCorrection","selector","property","inverted","supportedProperties","setSettings","options","collection","collectionType","Array","isArray","entry","entryType","push","indexOf","setCorrections","styler","id","element","querySelector","createElement","type","appendChild","updateStyle","$base","disabled","sheet","cssRules","insertRule","$scrollbar","deleteRule","$lock","$corrections","gap","factor","lock","vw","innerWidth","vh","innerHeight","_state","scrollTop","scrollLeft","scrollWidth","scrollHeight","clientWidth","clientHeight","setState","dispatchEvent","unlock","timer","addEventListener","clearTimeout","setTimeout","toggle","isLocked","setOptions"],"mappings":"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","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('bodyScroll', factory) :\n    (global.bodyScroll = factory());\n}(this, (function () { 'use strict';\n\n    const html = document.documentElement;\n    const head = document.head || document.getElementsByTagName('head')[0];\n\n    const ua = navigator.userAgent;\n    const isSafari = !!ua.match(/Version\\/[\\d\\.]+.*Safari/);\n    const isIOS = /iPad|iPhone|iPod/.test(ua) && !window.MSStream;\n\n    const isSafariIOS = isIOS && isSafari;\n\n    const BodyScrollEvent = (() => {\n        if (typeof window.CustomEvent === 'function') {\n            return window.CustomEvent;\n        }\n\n        function CustomEvent(event, params) {\n            params = params || {\n                bubbles: false,\n                cancelable: false,\n                detail: undefined\n            };\n\n            const evt = document.createEvent('CustomEvent');\n\n            evt.initCustomEvent(\n                event,\n                params.bubbles,\n                params.cancelable,\n                params.detail\n            );\n\n            return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        return CustomEvent;\n    })();\n\n    let status = false;\n    const setStatus = (bool = true) => (status = bool);\n\n    // TODO: cleanup!\n\n    let state = {\n        scroll: {\n            top: 0,\n            left: 0\n        },\n        html: {\n            width: 'auto',\n            height: 'auto'\n        },\n        body: {\n            width: 'auto',\n            height: 'auto',\n            paddingRight: 0,\n            paddingBottom: 0 // not useful // TODO: check\n        },\n        scrollbars: {\n            y: 0,\n            x: 0\n        }\n    };\n\n    const setState = () => {\n        const vw = window.innerWidth;\n        const vh = window.innerHeight;\n\n        let _state = {\n            ...state,\n            ...{\n                scroll: {\n                    top: html.scrollTop,\n                    left: html.scrollLeft\n                }\n            }\n        };\n\n        if (isSafariIOS) {\n            _state.html = {\n                width: vw + _state.scroll.left, // - _state.scrollbars.y, // ios doesn't have scrollbars anyway...\n                height: vh + _state.scroll.top // - _state.scrollbars.x\n            };\n\n            _state.body = {\n                width: html.scrollWidth,\n                height: html.scrollHeight\n            };\n        } else {\n            const width = html.clientWidth;\n            const height = html.clientHeight;\n\n            _state.scrollbars = {\n                y: vw > width ? vw - width : 0,\n                x: vh > height ? vh - height : 0\n            };\n\n            _state.body.paddingRight = _state.scrollbars.y;\n            // _state.body.paddingBottom = _state.scrollbars.x; // not useful // TODO: check\n        }\n\n        state = _state;\n    };\n\n    let settings = {\n        important: true,\n        corrections: []\n    };\n\n    const defaultCorrection = {\n        selector: null,\n        property: 'margin-right',\n        inverted: false\n    };\n\n    const supportedProperties = [\n        'margin-right',\n        'margin-bottom',\n        'padding-right',\n        'padding-bottom',\n        'right',\n        'bottom'\n    ];\n\n    const setCorrections = (collection = []) => {\n        let corrections = [];\n\n        const collectionType = typeof collection;\n        if (\n            collectionType === 'string' ||\n            (!Array.isArray(collection) && collectionType === 'object')\n        ) {\n            collection = [collection];\n        }\n\n        collection.forEach(entry => {\n            if (entry) {\n                const entryType = typeof entry;\n\n                if (entryType === 'string') {\n                    corrections.push({\n                        ...defaultCorrection,\n                        ...{\n                            selector: entry\n                        }\n                    });\n                }\n\n                if (\n                    !Array.isArray(entry) &&\n                    entryType === 'object' &&\n                    entry.selector &&\n                    (!entry.property ||\n                        supportedProperties.indexOf(entry.property) > -1)\n                ) {\n                    corrections.push({\n                        ...defaultCorrection,\n                        ...entry\n                    });\n                }\n            }\n        });\n\n        return corrections;\n    };\n\n    const setSettings = (options = {}) => {\n        settings = {\n            ...settings,\n            ...options\n        };\n\n        settings.corrections = setCorrections(settings.corrections);\n    };\n\n    const styler = id => {\n        id = `body-scroll__${id}`;\n\n        let element = head.querySelector(`style#${id}`);\n\n        if (!element) {\n            element = document.createElement('style');\n            element.type = 'text/css';\n            element.id = id;\n            head.appendChild(element);\n        }\n\n        return element;\n    };\n\n    const updateStyle = () => {\n        const important = settings.important ? '!important' : '';\n\n        const $base = styler('base');\n        $base.disabled = !status;\n        if (!$base.sheet.cssRules.length) {\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html,\n            body {\n                margin: 0${important};\n                min-width: auto${important};\n                min-height: auto${important};\n                max-width: none${important};\n                max-height: none${important};\n            }\n        `, 0);\n            // prettier-ignore\n            $base.sheet.insertRule(`\n            html {\n                padding: 0${important};\n            }\n        `, 1);\n        }\n\n        const $scrollbar = styler('bar');\n        $scrollbar.disabled = !status;\n        if ($scrollbar.sheet.cssRules.length) {\n            $scrollbar.sheet.deleteRule(1);\n            $scrollbar.sheet.deleteRule(0);\n        }\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        html {\n            width: ${state.html.width}px${important};\n            height: ${state.html.height}px${important};\n        }\n    `, 0);\n        // prettier-ignore\n        $scrollbar.sheet.insertRule(`\n        body{\n            width: ${state.body.width}px${important};\n            height: ${state.body.height}px${important};\n            padding: 0 ${state.body.paddingRight}px ${state.body.paddingBottom}px 0${important};\n        }\n    `, 1);\n\n        const $lock = styler('lock');\n        $lock.disabled = !status;\n        if (isSafariIOS) {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html,\n                body {\n                    overflow: visible${important};\n                }\n            `, 0);\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                html {\n                    position: fixed${important};\n                }\n            `, 1);\n            } else {\n                $lock.sheet.deleteRule(2);\n            }\n\n            // prettier-ignore\n            $lock.sheet.insertRule(`\n            html {\n                top: ${state.scroll.top * -1}px${important};\n                left: ${state.scroll.left * -1}px${important};\n            }\n        `, 2);\n        } else {\n            if (!$lock.sheet.cssRules.length) {\n                // prettier-ignore\n                $lock.sheet.insertRule(`\n                body {\n                    overflow: hidden${important};\n                }\n            `, 0);\n            }\n        }\n\n        const corrections = settings.corrections;\n        const $corrections = styler('corrections');\n\n        // prettier-ignore\n        for (let i = $corrections.sheet.cssRules.length - 1; i >= 0; i--) {\n            $corrections.sheet.deleteRule(i);\n        }\n\n        corrections.forEach(entry => {\n            const gap =\n                state.scrollbars[entry.property.indexOf('right') > -1 ? 'y' : 'x'];\n\n            if (gap > 0) {\n                let factor = 1;\n\n                if (!status) {\n                    factor = entry.inverted ? -1 : 0;\n                }\n\n                // prettier-ignore\n                $corrections.sheet.insertRule(`\n                ${entry.selector} {\n                    ${entry.property}: ${gap * factor}px${settings.important ? '!important' : ''};\n                }\n            `);\n            }\n        });\n    };\n\n    const lock = () => {\n        if (!status) {\n            setStatus(true);\n\n            setState();\n\n            updateStyle();\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollLock'));\n        }\n    };\n\n    const unlock = () => {\n        if (status) {\n            setStatus(false);\n\n            updateStyle();\n\n            html.scrollTop = state.scroll.top;\n            html.scrollLeft = state.scroll.left;\n\n            window.dispatchEvent(new BodyScrollEvent('bodyScrollUnlock'));\n        }\n    };\n\n    let timer = null;\n\n    window.addEventListener('resize', () => {\n        clearTimeout(timer);\n        \n        timer = setTimeout(() => {\n            if (status) {\n                unlock();\n\n                lock();\n            }\n        }, 500);\n    });\n\n    var bodyScroll = {\n        lock: lock,\n        unlock: unlock,\n        toggle: () => (!status ? lock() : unlock()),\n        isLocked: () => status,\n        setOptions: (options = {}) => {\n            setSettings(options);\n\n            updateStyle();\n        }\n    };\n\n    return bodyScroll;\n\n})));\n"],"file":"body-scroll.min.js"}